src/trend_analysis/data.py:60:21: F821 Undefined name `validate_market_data`
   |
58 |     payload = _normalise_numeric_strings(payload)
59 |     try:
60 |         validated = validate_market_data(payload, origin=origin)
   |                     ^^^^^^^^^^^^^^^^^^^^ F821
61 |     except MarketDataValidationError as exc:
62 |         if errors == "raise":
   |

src/trend_analysis/data.py:98:16: F821 Undefined name `errors`
    |
 96 |         if not _is_readable(mode):
 97 |             message = f"Permission denied accessing file: {path}"
 98 |             if errors == "raise":
    |                ^^^^^^ F821
 99 |                 raise PermissionError(message)
100 |             logger.error(message)
    |

src/trend_analysis/data.py:173:5: F822 Undefined name `load_parquet` in `__all__`
    |
171 | __all__ = [
172 |     "load_csv",
173 |     "load_parquet",
    |     ^^^^^^^^^^^^^^ F822
174 |     "validate_dataframe",
175 |     "identify_risk_free_fund",
    |

src/trend_analysis/data.py:174:5: F822 Undefined name `validate_dataframe` in `__all__`
    |
172 |     "load_csv",
173 |     "load_parquet",
174 |     "validate_dataframe",
    |     ^^^^^^^^^^^^^^^^^^^^ F822
175 |     "identify_risk_free_fund",
176 |     "ensure_datetime",
    |

tests/test_validators.py:160:16: F821 Undefined name `detect_frequency`
    |
158 |         index = pd.date_range("2023-01-01", periods=5, freq="D")
159 |         df = pd.DataFrame(index=index)
160 |         assert detect_frequency(df) == "daily"
    |                ^^^^^^^^^^^^^^^^ F821
161 | 
162 |     def test_unknown_frequency(self) -> None:
    |

tests/test_validators.py:164:16: F821 Undefined name `detect_frequency`
    |
162 |     def test_unknown_frequency(self) -> None:
163 |         df = pd.DataFrame(index=[])
164 |         assert detect_frequency(df) == "unknown"
    |                ^^^^^^^^^^^^^^^^ F821
    |

tests/test_validators.py:169:20: F821 Undefined name `create_sample_template`
    |
167 | class TestCreateSampleTemplate:
168 |     def test_template_contains_expected_columns(self) -> None:
169 |         template = create_sample_template()
    |                    ^^^^^^^^^^^^^^^^^^^^^^ F821
170 |         assert "Date" in template.columns
171 |         assert template.shape[0] == 12
    |

Found 7 errors.

