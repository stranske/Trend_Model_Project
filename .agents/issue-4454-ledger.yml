version: 1
issue: 4454
base: phase-3
branch: codex/issue-4454
tasks:
  - id: task-01
    title: Add extraction of `risk_diagnostics` scalar fields in `src/trend_analysis/llm/result_metrics.py`
      (support dicts and objects with attributes).
    status: done
    started_at: '2026-01-21T14:23:21Z'
    finished_at: '2026-01-21T14:23:32Z'
    commit: d19fc5d5c29958c70239bb591eb141cd61982984
    notes: []
  - id: task-02
    title: Include turnover fields (e.g., `turnover`, `turnover_value`) in the metric
      catalog with source `[from risk_diagnostics]`.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-03
    title: Include transaction cost fields (e.g., `transaction_cost`, `cost`, `per_trade_bps`,
      `half_spread_bps`) in the metric catalog when present.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-04
    title: When `details["turnover"]` is present as a `pd.Series` (multi-period),
      add scalar summaries under deterministic paths (e.g., `turnover.latest`, `turnover.mean`)
      with an explicit source label.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-05
    title: Update metric synonyms / keyword mapping so "turnover" and "transaction
      cost" are treated as available when entries exist.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-06
    title: Update `tests/test_result_metric_extraction.py` to validate new entries
      are extracted and formatted with correct `[from ...]` sources.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-07
    title: Update `tests/test_result_validation.py` to ensure `detect_unavailable_metric_requests()`
      does not flag turnover when turnover entries exist.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-08
    title: Add extraction of `risk_diagnostics` scalar fields in `src/trend_analysis/llm/result_metrics.py`
      (support dicts and objects with attributes).
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-09
    title: Include turnover fields (e.g., `turnover`, `turnover_value`) in the metric
      catalog with source `[from risk_diagnostics]`.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-10
    title: Include transaction cost fields (e.g., `transaction_cost`, `cost`, `per_trade_bps`,
      `half_spread_bps`) in the metric catalog when present.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-11
    title: When `details["turnover"]` is present as a `pd.Series` (multi-period),
      add scalar summaries under deterministic paths (e.g., `turnover.latest`, `turnover.mean`)
      with an explicit source label.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-12
    title: Update metric synonyms / keyword mapping so "turnover" and "transaction
      cost" are treated as available when entries exist.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-13
    title: Update `tests/test_result_metric_extraction.py` to validate new entries
      are extracted and formatted with correct `[from ...]` sources.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-14
    title: Update `tests/test_result_validation.py` to ensure `detect_unavailable_metric_requests()`
      does not flag turnover when turnover entries exist.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-15
    title: '`extract_metric_catalog()` returns at least one turnover entry when turnover
      is present in `risk_diagnostics` or `details["turnover"]`.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-16
    title: '`extract_metric_catalog()` returns at least one transaction cost entry
      when cost fields exist in `risk_diagnostics`.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-17
    title: '`format_metric_catalog()` renders these entries with explicit `[from <source>]`
      annotations.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-18
    title: '`detect_unavailable_metric_requests("Report turnover", entries)` returns
      no missing turnover keyword when turnover entries exist.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-19
    title: All unit tests pass.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-20
    title: '`extract_metric_catalog()` returns at least one turnover entry when turnover
      is present in `risk_diagnostics` or `details["turnover"]`.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-21
    title: '`extract_metric_catalog()` returns at least one transaction cost entry
      when cost fields exist in `risk_diagnostics`.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-22
    title: '`format_metric_catalog()` renders these entries with explicit `[from <source>]`
      annotations.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-23
    title: '`detect_unavailable_metric_requests("Report turnover", entries)` returns
      no missing turnover keyword when turnover entries exist.'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-24
    title: All unit tests pass.
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
