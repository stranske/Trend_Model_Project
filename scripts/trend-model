#!/usr/bin/env bash
# Development wrapper for trend-model CLI
# Makes 'trend-model' command available without requiring package installation

# Ensure deterministic hashes unless caller explicitly set one
if [ -z "${PYTHONHASHSEED+x}" ]; then
    export PYTHONHASHSEED=0
fi

# Provide a default pipeline seed while allowing overrides
if [ -z "${TREND_PIPELINE_SEED+x}" ]; then
    export TREND_PIPELINE_SEED=42
fi

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(dirname "$SCRIPT_DIR")"

# Set PYTHONPATH to include the src directory
export PYTHONPATH="${PROJECT_ROOT}/src:${PYTHONPATH}"

# Activate virtual environment if it exists
if [ -f "${PROJECT_ROOT}/.venv/bin/activate" ]; then
    source "${PROJECT_ROOT}/.venv/bin/activate"
fi

# Run the CLI module with all arguments passed through
PYTHON_EXEC="python"
if [ -x "${PROJECT_ROOT}/.venv/bin/python" ]; then
    PYTHON_EXEC="${PROJECT_ROOT}/.venv/bin/python"
fi
exec "$PYTHON_EXEC" -m trend_analysis.cli "$@"