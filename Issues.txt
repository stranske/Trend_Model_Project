1. Keepalive: event‑driven listener on Gate completion (cron stays as fallback)

Labels: agent:codex, agents, automation, workflows, ci, devops, priority: medium, risk:low, enhancement

Why

The current keepalive loop relies on periodic scans, which introduces latency and racy timing with autofix. A small event‑driven listener that fires when Gate completes on a PR makes keepalive responsive while leaving the cron loop as a safety net.

Tasks

Add a workflow that triggers on workflow_run of “Gate” with types: completed, filters to successful PR events, and dispatches a per‑PR keepalive job when keepalive is opted in.
Honor the existing opt‑in signal (e.g., agents:keepalive label or a sentinel in the latest @codex comment if your bridge sets one) before dispatching.
Set concurrency per PR so only one keepalive cycle can run for a given PR at a time and do not cancel in‑flight runs.
Emit a short summary each time: PR number, whether keepalive dispatched, and why it was skipped if not.
Leave the cron‑based keepalive in place as a fallback; it should also respect opt‑in and per‑PR concurrency.

Acceptance criteria

A successful Gate run on an opted‑in PR results in exactly one new keepalive cycle without waiting for the cron tick.
Non‑opt‑in PRs do not receive keepalive cycles from the event listener.
Per‑PR concurrency prevents overlapping keepalive runs for the same PR.
Run summaries show counts of dispatched and skipped PRs.

Implementation notes

Use on: workflow_run: workflows: ["Gate"] to match the existing workflow name and types: ["completed"].
Filter to PR events (github.event.workflow_run.event == 'pull_request') and conclusion == 'success'.
Check opt‑in by reading PR labels (e.g., agents:keepalive) or using your bridge’s sentinel logic, then dispatch the per‑PR keepalive workflow via actions.createWorkflowDispatch.
Keep permissions: at least actions: write, contents: write, pull-requests: write, issues: write. 
GitHub

2. Keepalive: Pause/Resume via label gating and visible status

Labels: agent:codex, agents, automation, workflows, devops, ci, priority: medium, risk:low, enhancement

Why

Sometimes you need to stop the loop to review changes or debug a test. A zero‑code, reversible Pause/Resume switch keeps keepalive predictable without removing opt‑in or rewriting configs.

Tasks

Create a repository label agents:paused with description “Temporarily disable keepalive cycles for this PR.”
Modify the keepalive scanner to exclude PRs that have agents:paused.
Add an early‑exit guard to the per‑PR keepalive job that checks for agents:paused and exits successfully if present.
Maintain a single sticky “Keepalive status” comment per PR that reads “Active,” “Paused,” “Waiting for checks,” or “Complete,” updated in place each cycle.
Document the Pause/Resume control (label name, behavior, and where status appears) in the workflow documentation alongside the existing keepalive description.

Acceptance criteria

Applying agents:paused to an opted‑in PR prevents further keepalive cycles from both the scanner and any event‑driven listener.
Removing agents:paused resumes the loop on the next eligible event (Gate completion or cron tick), with the status comment flipping back to “Active.”
No duplicate cycles occur when pausing and immediately resuming; per‑PR concurrency prevents overlap.
Pause does not alter other labels or merge state.

Implementation notes

Apply the label gate in both places: the repository‑wide scanner and the per‑PR workflow, to avoid races.
Have the per‑PR guard exit with code 0 so the run is a no‑op, not a failure.
Keep the status comment bot‑owned so subsequent updates can edit it. 
GitHub
+1

3. Keepalive OFF: Verify manual @codex plan produces scope and AC, no automated follow‑ups

Labels: agent:codex, agents, automation, testing, ci, devops, priority: medium, risk:low, status: ready

Why

We need a negative test to prove the manual flow (Version 1) never triggers keepalive. This protects against accidental opt‑in via comments or labels.

Tasks

Create this Issue and apply agent:codex so the Codex Issue Bridge creates or updates a PR from the Issue content.
In the PR, comment @codex start to request a scoped task list, acceptance criteria, and implementation notes. Do not include any keepalive sentinel or keepalive label.
Make a small manual commit that addresses a subset of the acceptance criteria; let Gate and Post‑CI complete.
Observe that no keepalive cycles run and no keepalive status thread appears.

Acceptance criteria

Exactly one Codex planning response is posted to the PR with the task list and acceptance criteria.
No keepalive runs are triggered for this PR: no dispatcher/worker/conveyor cycles and no keepalive status comment.
Gate and Post‑CI behave normally; autofix runs only if you explicitly add autofix:clean.

Implementation notes

Use the same sections here (Why, Tasks, Acceptance criteria, Implementation notes) so the Bridge mirrors content into the PR description cleanly. 
GitHub

4. Keepalive ON: Verify event‑driven loop executes after Gate until all AC are met

Labels: agent:codex, agents, automation, testing, ci, devops, priority: medium, risk:medium, status: ready

Why

We need a positive end‑to‑end test to confirm the keepalive loop runs automatically after each successful Gate, updating the branch and checklist until the acceptance criteria are complete.

Tasks

Create this Issue and apply agent:codex so the Codex Issue Bridge creates or updates a PR from the Issue content.
In the PR, opt in to keepalive with a comment like @codex plan-and-execute [keepalive] or by applying the agents:keepalive label if your bridge supports label‑based opt‑in.
Observe the first Codex execution push an update and wait for Gate to complete.
After Gate succeeds, verify that the event‑driven keepalive listener dispatches the next Codex cycle automatically.
If autofix is enabled via autofix:clean, verify keepalive waits for all checks to finish before dispatching again.
Repeat until all acceptance criteria are checked off in the PR, then confirm the loop stops and the final status is “Complete.”

Acceptance criteria

After each successful Gate, exactly one keepalive cycle runs for the PR and updates the branch or checklist.
Per‑PR concurrency prevents overlapping cycles for the same PR.
The sticky status comment progresses through “Active → Waiting for checks → Active → Complete.”
When all acceptance criteria are met, no further cycles are dispatched.

Implementation notes

The event‑driven listener should key off the “Gate” workflow name, so keep it stable.
If label‑based opt‑in is used, ensure the listener and scanner both require the same label to avoid drift.
Use your existing Issue Bridge format so the plan and AC land in the PR body exactly where Codex expects them.
