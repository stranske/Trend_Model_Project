1) Fix invalid permissions in repo-health-self-check.yml

Labels: ci, devops, docs
Rationale: The workflow is currently invalid due to unsupported permissions keys (metadata, administration) and never runs. You can’t get health signals from a dead canary. Evidence: the Actions UI shows “Invalid workflow file” with unknown permission keys for this file. 
GitHub

Title: Fix invalid permissions and make repo-health-self-check.yml runnable

Acceptance criteria

The workflow .github/workflows/repo-health-self-check.yml validates and appears in the Actions list without the “Invalid workflow file” banner.

A manual workflow_dispatch run completes on the default branch and publishes a concise summary in the job’s step summary.

(Optional) A weekly schedule trigger runs successfully and produces the same summary.

The workflow requests only the minimum required permissions (no unsupported keys).

Task list

 Edit .github/workflows/repo-health-self-check.yml:

Replace invalid permission keys with supported ones. Start with:

permissions:
  contents: read
  issues: read
  pull-requests: read
  actions: read


Keep triggers to workflow_dispatch and, if useful, a light weekly cron.

 Add a “Repo health summary” step that writes a short table to $GITHUB_STEP_SUMMARY.

 Commit to default branch. Manually run once to verify success.

 Add a one-liner in docs/ci/WORKFLOWS.md describing purpose, triggers, and minimum permissions.

Implementation notes

This job should stay read‑only. If it ever needs to open/label issues, grant issues: write narrowly to that job only.

Keep run time under a minute so it remains cheap, and don’t fail the job for soft signals (log them in the summary instead).

2) Repair reuse-agents.yml invalid syntax (timeout on a uses: job)

Labels: agents, ci, devops
Rationale: timeout-minutes is set on a job that uses another workflow, which is not allowed. Evidence: the workflow run shows “Unexpected value 'timeout-minutes'” on the call job. 
GitHub

Title: Fix reuse-agents.yml by removing invalid timeout-minutes and pushing timeouts into the reusable workflow

Acceptance criteria

.github/workflows/reuse-agents.yml validates; no “Invalid workflow file” annotation in Actions.

Timeouts are enforced inside .github/workflows/reusable-70-agents.yml per job instead of at the caller job level.

A manual workflow_dispatch of Agents 70 Orchestrator that delegates through reuse-agents completes the orchestration path without YAML errors.

Task list

 Remove timeout-minutes from .github/workflows/reuse-agents.yml where the job uses ./.github/workflows/reusable-70-agents.yml.

 Add timeout-minutes: to the long‑running jobs in .github/workflows/reusable-70-agents.yml (e.g., readiness probe, bootstrap, keepalive, watchdog) with sensible bounds (15–30 min).

 Trigger a workflow_dispatch of Agents 70 Orchestrator to exercise the path and confirm the absence of the prior annotation.

 Document the timeout location in docs/ci_reuse.md.

Implementation notes

Timeouts on called jobs are the portable way to bound reusable workflows. Keep per‑job timeouts near actual worst‑case plus ~25%.

3) Retire legacy agent-watchdog.yml in favor of Orchestrator’s watchdog

Labels: agents, devops, ci
Rationale: The agent-watchdog workflow is explicitly marked deprecated in its own YAML and its responsibilities are covered by the orchestrator’s enable_watchdog path. Keeping both invites duplication. Evidence: deprecation note inside the workflow file. 
GitHub

Title: Remove agent-watchdog.yml (redundant with orchestrator enable_watchdog)

Acceptance criteria

.github/workflows/agent-watchdog.yml is deleted from the repo.

Orchestrator job path with enable_watchdog: true continues to function.

Docs point contributors to use the Orchestrator and do not reference the legacy watchdog.

Task list

 Delete .github/workflows/agent-watchdog.yml.

 Confirm Agents 70 Orchestrator still exposes a watchdog path and succeeds.

 Update references in docs/WORKFLOW_GUIDE.md and docs/ci/WORKFLOWS.md to remove mentions of the legacy watchdog.

 Close any open Issues that refer to agent-watchdog, or retarget them to the Orchestrator where appropriate.

Implementation notes

If you want a watchdog on issue label changes, route those events through the Orchestrator’s workflow_dispatch with inputs rather than maintaining a separate workflow.

4) Decide the fate of agents-consumer.yml and stop the failure churn

Labels: agents, ci-failure, devops
Rationale: agents-consumer.yml has a long history of failing runs and duplicates responsibilities now covered by the Agents 70 Orchestrator. If it isn’t providing unique value, shut it down or constrain it to manual runs. Evidence: page shows a very high count of failed runs over time. 
GitHub

Title: Consolidate or disable agents-consumer.yml to eliminate duplicate, failing automation

Acceptance criteria

Either:

The consumer workflow is disabled except for workflow_dispatch, or

Its unique functionality is folded into reusable-70-agents.yml and the file is removed.

After the change, there are no scheduled or issue‑event‑triggered agents-consumer runs in the next 48 hours.

Docs reflect the single source of automation truth: the Orchestrator.

Task list

 Inventory what agents-consumer.yml does that Agents 70 Orchestrator does not.

 Choose one:

 If unique value is negligible: remove schedule/issue triggers so it only runs by workflow_dispatch, or delete the workflow.

 If unique value exists: migrate that logic into .github/workflows/reusable-70-agents.yml, then remove the consumer file.

 Add a concurrency: group for any remaining manual path to avoid re‑trigger storms.

 Update docs/ci/WORKFLOWS.md to describe the final, simplified agent automation path.

 Tag this Issue with ci-failure and close it only after 48 hours of clean Action history.

Implementation notes

If you keep any consumer functionality, give it a clear concurrency: group: agents-consumer-${{ github.ref }} with cancel-in-progress: true.

5) Enforce PR branch protection on the required gate check

Labels: ci, devops, config, docs
Rationale: The gate workflow is now the canonical PR bouncer, running Python 3.11/3.12 tests plus a Docker smoke. Make it required so merges can’t end‑run quality. The gate is valid and shows the expected jobs in recent runs. 
GitHub

Title: Require the gate workflow for merges into the default branch

Acceptance criteria

The default branch’s protection rule requires the gate check to pass before merging.

Any legacy “CI” required checks are removed or replaced with gate.

A fresh PR shows the gate check as required and blocks merge until passing.

Task list

 In repository settings, add or edit the protection rule for the default branch:

Require status checks to pass: select gate.

Enable “Require branches to be up to date” to avoid stale merges.

 Remove any old required check names that no longer exist.

 Update CONTRIBUTING.md to state “Passing the gate check is required to merge.”

Implementation notes

The current gate.yml jobs are named “core tests (3.11)”, “core tests (3.12)”, “docker smoke” and a final “gate” job that summarizes and enforces. Keep those exact names stable so humans know what failed. 
GitHub

6) Update docs to reflect the simplified CI/automation topology

Labels: docs, ci, devops
Rationale: You’ve converged on a clear topology: PRs go through gate; maintenance runs are consolidated; agent automation is orchestrated. The docs still mention legacy and self‑test variants that confuse contributors. The README already points to several doc files that should be the canonical source. 
GitHub

Title: Refresh CI/automation docs to match the final workflow set

Acceptance criteria

docs/ci/WORKFLOWS.md lists only the active workflows, their triggers, permissions, and required vs optional.

docs/WORKFLOW_GUIDE.md and docs/ci_reuse.md show the Orchestrator as the sole entry point for agent automation and do not reference agent-watchdog or unconstrained agents-consumer.

CONTRIBUTING.md calls out the gate as the required merge check and links to recommended local scripts (style gate, full gate).

Task list

 Remove references to agent-watchdog and deprecated consumer flows.

 Add a small diagram or table for the gate pipeline and summarize failure reporting (step summary, links).

 Document how to manually trigger the Orchestrator via workflow_dispatch with typical inputs.

 Add a “troubleshooting” slice for agent bootstrap and readiness signals.

Implementation notes

Keep doc examples stable with current job names and inputs so newcomers recognize what they see in the Actions UI.

Optional low‑effort, high‑value polish (skip if you’re done with this topic)

Lightweight failure rollup: a single “CI failures in last 24h” issue that’s updated in place by the repo-health job instead of emitting many comments. Label it ci-failure so it’s easy to find.
