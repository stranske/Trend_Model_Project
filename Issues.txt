1) Agents: fix Orchestrator (agents-70-orchestrator.yml) inputs limit and consolidate to params_json

Labels: agents, ci, devops, bug

Why
The Orchestrator fails to load because it defines more than 10 inputs for workflow_dispatch (“you may only define up to 10 inputs”). Replace the long input list with a single JSON input, parse it in a resolve step, and keep at most a couple of top-level toggles if absolutely needed. 
GitHub

Acceptance criteria

.github/workflows/agents-70-orchestrator.yml validates; “Invalid workflow file” error is gone.

A manual run with a single JSON input (params_json) completes green.

The Verify Assignment leg invokes agents-64-verify-agent-assignment.yml via workflow_call and runs at least once.

The run summary includes a compact table of effective parameters.

Task list

 In on.workflow_dispatch, remove the long list of inputs. Leave only:

on:
  schedule:
    - cron: '*/20 * * * *'
  workflow_dispatch:
    inputs:
      params_json:
        description: 'JSON payload of orchestrator params'
        required: false
        default: '{}'


 In the “Resolve Parameters” step, replace references to inputs.<old> with a single parse of inputs.params_json, merging sensible defaults:

env:
  PARAMS_JSON: ${{ github.event_name == 'workflow_dispatch' && github.event.inputs.params_json || '{}' }}
with:
  script: |
    const defaults = { enable_readiness: 'false', readiness_agents: 'copilot,codex', require_all: 'false',
                       enable_preflight: 'false', codex_user: '', enable_verify_issue: 'false',
                       verify_issue_number: '', verify_issue_valid_assignees: 'copilot,chatgpt-codex-connector,stranske-automation-bot',
                       enable_watchdog: 'true', draft_pr: 'false', options_json: '{}' };
    let user = {};
    try { user = JSON.parse(process.env.PARAMS_JSON || '{}'); } catch(e) { core.warning('Bad params_json; using defaults'); }
    const merged = { ...defaults, ...user };
    core.setOutput('enable_readiness', String(merged.enable_readiness));
    // set all other outputs...


 Ensure all downstream jobs read outputs from resolve-params only (no direct inputs.*).

 Confirm agents-64-verify-agent-assignment.yml is referenced correctly by the Orchestrator job that performs verification and that agents-64-verify-agent-assignment.yml has on: workflow_call.

 Manually run Orchestrator with:

{ "enable_verify_issue":"true", "verify_issue_number":"1234" }


and attach the run link to this Issue.

Implementation notes

Keep per-job timeout-minutes inside the reusable workflow instead of the caller; GitHub ignores timeouts on uses: jobs.

2) Repo Health: fix invalid permission and degrade gracefully on branch‑protection probe

Labels: ci, devops, bug, config, docs

Why
repo-health-self-check.yml is rejected by Actions due to an unsupported permission key: permissions.administration: read. The entire check never runs. Use only supported permissions and gate privileged calls behind an optional PAT. 
GitHub

Acceptance criteria

The workflow validates and runs on workflow_dispatch and schedule.

If SERVICE_BOT_PAT is present, branch‑protection is checked via API; if not, the step logs a notice and continues, not a red X.

The job writes a short summary table to $GITHUB_STEP_SUMMARY listing each check and outcome.

Task list

 Edit .github/workflows/repo-health-self-check.yml:

permissions:
  contents: read
  issues: write
  pull-requests: read
  actions: read


Remove administration. 
GitHub

 For the branch-protection script step, add with: github-token: ${{ secrets.SERVICE_BOT_PAT }} and handle the missing‑token case by core.notice(...) and a neutral output value.

 Add a final “Aggregate & Summarize” step writing a Markdown table to $GITHUB_STEP_SUMMARY.

 Trigger a manual run and link it here.

Implementation notes

Keep the check read‑only unless it needs to open/update one rolling “health failed” issue. If writing, scope issues: write only for that job.

3) Retire legacy agent-watchdog.yml and route all checks through Orchestrator

Labels: agents, devops, enhancement, ci

Why
The legacy watchdog is still running frequently, overlapping with the Orchestrator’s enable_watchdog path and adding noise. 233 lifetime runs says it’s not shy. 
GitHub

Acceptance criteria

.github/workflows/agent-watchdog.yml is removed or has no active triggers.

Orchestrator’s watchdog path is the only watchdog mechanism.

ARCHIVE_WORKFLOWS.md updated with when/why it was retired.

Task list

 Delete agent-watchdog.yml or comment out all triggers, leaving only a header noting its deprecation.

 Confirm the Orchestrator still runs its watchdog checks when params_json.enable_watchdog resolves to true.

 Add a note to ARCHIVE_WORKFLOWS.md describing the replacement path.

4) Self‑tests: make every selftest-* workflow manual‑only

Labels: ci, devops, docs

Why
Self-tests (maint-43-selftest-pr-comment.yml, maint-44-*, maint-48-*, pr-20-selftest-pr-comment.yml, selftest-*) still appear under Actions. They should be examples invoked explicitly, not ambient noise. 
GitHub

Acceptance criteria

All self-test workflows trigger only on workflow_dispatch.

No scheduled or PR triggers remain for these files.

CONTRIBUTING.md has a 3–5 sentence section on how to run them and what they prove.

Task list

 For each self-test file, replace on: with:

on:
  workflow_dispatch:
    inputs:
      reason:
        description: 'Why are you running this example?'
        required: false
        default: 'manual test'


 Update CONTRIBUTING.md with a short “Self-test workflows are examples; run manually” section.

 Manually trigger one self-test to confirm it’s alive and add the run link here.

5) Agents “Consumers” (61/62): either archive or restrict to manual

Labels: agents, devops, enhancement, docs

Why
The “Agents 61 Consumer Compat” and “Agents 62 Consumer” workflows still exist but are effectively idle. Decide deliberately: keep them as manual/compat wrappers or archive them to reduce surface area. 
GitHub

Acceptance criteria

Either both consumer workflows are archived, or they trigger only via workflow_dispatch and are clearly marked as compatibility shims.

Agents.md notes the canonical entrypoint is the Orchestrator.

Task list

 If keeping: strip all event/schedule triggers; leave workflow_dispatch only and add a concurrency guard:

concurrency:
  group: agents-consumer-${{ github.ref }}
  cancel-in-progress: true


 If archiving: move files to Old/ or remove and document in ARCHIVE_WORKFLOWS.md.

 Update Agents.md with the final stance.

6) Make Gate a required status in branch protection

Labels: ci, devops, config, docs

Why
Gate is healthy and central to PR quality. Lock it in branch protection so merges can’t slip around it. 
GitHub

Acceptance criteria

Default branch protection requires the Gate check to pass.

A test PR shows “Gate” as a required status and blocks merge until green.

CONTRIBUTING.md states “Passing Gate is required to merge to the default branch.”

Task list

 Settings → Branches → Default branch rule → Require status checks to pass → select Gate and enable “Require branches to be up to date.”

 Open a draft PR that intentionally fails a Gate job, verify the block, then push a fix.

 Update CONTRIBUTING.md.

Implementation notes

The repo‑health job (Issue 2) can verify this post‑fix without failing the whole run if the API token is missing.

7) Agents Verify Assignment: guarantee at least one successful run and accept the automation bot

Labels: agents, devops, ci, enhancement, documentation

Why
The verification workflow exists but has no runs, and the Orchestrator has been failing before it can exercise it. Once the Orchestrator inputs are fixed, we still need the verify path to succeed at least once and to treat your automation bot as a valid assignee. 
GitHub
+1

Acceptance criteria

agents-64-verify-agent-assignment.yml declares on: workflow_call with the inputs the Orchestrator provides.

A manual Orchestrator run with params_json including:

{ "enable_verify_issue":"true", "verify_issue_number":"<an issue you control>" }


completes green and logs which assignee satisfied verification.

The verify step treats stranske-automation-bot as valid when label rules indicate an agent action.

Task list

 Confirm verify workflow uses workflow_call and the expected inputs.

 Ensure the Orchestrator passes verify_issue_valid_assignees (e.g., copilot,chatgpt-codex-connector,stranske-automation-bot) via resolved params.

 Run the Orchestrator manually against a known issue and attach the run link here.

 Add a 2–3 line section in Agents.md describing when verification passes.

8) Post‑CI hygiene: keep the summary comment and failure tracker deduplicated

Labels: ci, devops, enhancement, documentation

Why
“Maint 46 Post CI” and “Maint 47 Check Failure Tracker” are working. Make sure renames and gating didn’t re‑introduce duplicate comments or duplicate failure issues. 
GitHub

Acceptance criteria

Post‑CI produces one consolidated comment per PR with stable job names and log links.

Failure Tracker maintains one open rolling failure issue per category, updating instead of spamming new issues.

A failing PR shows the correct behavior, then resolves cleanly when fixed.

Task list

 Verify the Post‑CI template uses current job names (“core tests (3.11)”, “core tests (3.12)”, “docker smoke”, “gate”).

 Ensure concurrency groups and comment‑upsert logic prevent duplicates.

 Trigger a synthetic failure to confirm the tracker updates one issue, not many; attach links.
