0) Adopt workflow numbering/naming convention and rename files

Labels: ci, devops, config, docs, enhancement

Title: Adopt workflow numbering scheme and rename files to match

Why: Names are metadata. A simple scheme makes it obvious what runs when, and prevents “is this safe to delete?” archaeology. We’ll use ranges by purpose and keep everything in .github/workflows:

00–19 PR gate & pre‑merge checks
Pattern: pr-XX-<name>.yml

30–39 Post‑CI maintenance
Pattern: maint-3X-<name>.yml

40–49 Repo health / policy checks
Pattern: health-4X-<name>.yml

60–79 Agents & issue automation
Pattern: agents-6X-<name>.yml

80–89 Self‑tests and sandboxes (manual only)
Pattern: selftest-8X-<name>.yml

Reusable building blocks
Pattern: reusable-<block>-<name>.yml (reuse across any band; still numbered where helpful, for example reusable-10-ci-python.yml, reusable-12-ci-docker.yml, reusable-70-agents.yml)

Proposed file rename map

Current file	New file
.github/workflows/pr-gate.yml	.github/workflows/pr-00-gate.yml
.github/workflows/maint-post-ci.yml	.github/workflows/maint-30-post-ci.yml
.github/workflows/repo-health-self-check.yml	.github/workflows/health-40-repo-selfcheck.yml
.github/workflows/agents-consumer.yml	.github/workflows/agents-62-consumer.yml (or delete/disable per Issue 3)
.github/workflows/agent-watchdog.yml	Delete (superseded; see Issue 4)
.github/workflows/reusable-ci.yml	.github/workflows/reusable-10-ci-python.yml
.github/workflows/reusable-docker.yml	.github/workflows/reusable-12-ci-docker.yml
.github/workflows/agents-43-codex-issue-bridge.yml	keep as‑is (already numbered)
.github/workflows/selftest-pr-comment.yml	.github/workflows/selftest-80-pr-comment.yml
.github/workflows/selftest-reusable-ci.yml	.github/workflows/selftest-81-reusable-ci.yml
.github/workflows/pr-20-selftest-pr-comment.yml	.github/workflows/selftest-82-pr-comment.yml
.github/workflows/maint-43-selftest-pr-comment.yml	.github/workflows/selftest-83-pr-comment.yml
.github/workflows/maint-44-selftest-reusable-ci.yml	.github/workflows/selftest-84-reusable-ci.yml
.github/workflows/maint-48-selftest-reusable-ci.yml	.github/workflows/selftest-88-reusable-ci.yml

Evidence that these files exist and/or are the active ones comes from your Actions list and recent Gate runs. 
GitHub
+1

Acceptance criteria

All workflows under .github/workflows follow the scheme above.

Any uses: ./.github/workflows/<old>.yml references are updated to the new names.

Docs that reference old filenames are updated (README.md, docs/WORKFLOW_GUIDE.md, docs/ci/WORKFLOWS.md, docs/ci_reuse.md). Current docs mention the reusable files and the workflow catalog. 
GitHub

Gate runs successfully from pr-00-gate.yml and calls the renamed reusables.

Task list

 Create branch chore/workflow-names.

 git mv files per the table above.

 Update callers:

In Gate, change uses: ./.github/workflows/reusable-ci.yml to uses: ./.github/workflows/reusable-10-ci-python.yml and reusable-docker.yml to reusable-12-ci-docker.yml. Your Gate currently calls the older names. 
GitHub

 Update docs to reflect the new names and bands.

 Open PR; verify the “Gate” workflow still fans out correctly and summarizes results.

Implementation notes

Use git grep -n "reusable-ci.yml\|reusable-docker.yml" to catch all references.

Keep the display names the same (e.g., name: Gate, name: Maint Post CI) so humans don’t lose continuity while names on disk change.

1) Fix invalid permissions in repo-health-self-check.yml

Labels: ci, devops, docs, bug

Title: Fix invalid permissions: keys in health-40-repo-selfcheck.yml and make it runnable

Why: The workflow fails to load due to unsupported permission keys (metadata, administration). That means no health signals and no branch‑protection verification. Error is shown directly in the run view. 
GitHub

Acceptance criteria

The workflow validates and shows up without “Invalid workflow file.”

A manual workflow_dispatch succeeds on the default branch and publishes a summary to the job’s step summary.

(Optional) A weekly cron run completes.

If branch‑protection API calls are required, the step uses a token with scope to read protection rules; otherwise it degrades gracefully.

Task list

 Rename file per Issue 0, then edit:

permissions:
  contents: read
  issues: read
  pull-requests: read
  actions: read


Remove metadata and administration. 
GitHub

 If checking branch protection, pass a PAT or GitHub App token to the script step:

with:
  github-token: ${{ secrets.SERVICE_BOT_PAT }}


 Add a single table summary to $GITHUB_STEP_SUMMARY.

 Run once via workflow_dispatch and confirm green.

Implementation notes

The run page shows the exact parser error with line numbers; fix that first to get signal back. 
GitHub

2) Repair agents-consumer.yml or disable it

Labels: agents, ci, devops, ci-failure

Title: Repair agents-62-consumer.yml (reusable call schema) or restrict to manual runs

Why: It doesn’t load. The parser complains about uses/secrets/with at job level and says runs-on is missing. That’s what happens when you call a workflow that isn’t declared with workflow_call or when the call syntax is misplaced. Current error excerpt is in the run view. 
GitHub

Acceptance criteria

Either:

The consumer successfully calls the reusable agents workflow with uses: ./.github/workflows/reusable-70-agents.yml, or

It’s restricted to workflow_dispatch only and removed from schedules and repo events.

No red “Invalid workflow file” tiles from this workflow in 48 hours.

Task list

 Ensure the callee reusable has on: workflow_call and defines inputs.

 In the consumer, define a job using the uses‑style call:

jobs:
  dispatch:
    uses: ./.github/workflows/reusable-70-agents.yml
    secrets: inherit
    with:
      # pass through parsed inputs...


 If you don’t need the consumer, delete schedule: and any event triggers, leaving only workflow_dispatch:.

 Add a concurrency: group to avoid re‑trigger storms.

Implementation notes

The run page shows the precise schema error; fix the contract first, then inputs. 
GitHub

3) Retire legacy agent-watchdog.yml

Labels: agents, devops, ci

Title: Remove agent-watchdog.yml (redundant with orchestrator’s watchdog path)

Why: It’s still firing on label changes and duplicating what your agents orchestration covers. It also adds noise and extra failure surface. The workflow runs list shows it active with hundreds of runs. 
GitHub

Acceptance criteria

agent-watchdog.yml is removed.

The orchestrator path that provides watchdog behavior continues to work.

No new watchdog runs appear in Actions.

Task list

 Delete .github/workflows/agent-watchdog.yml.

 Verify the orchestrator watchdog path still runs via workflow_dispatch (or clearly documented event).

 Update docs to point contributors to the orchestrator only.

4) Enforce PR branch protection on Gate

Labels: ci, devops, config, docs

Title: Require the Gate check for merges into the default branch

Why: The Gate is your single bouncer and it’s working: it runs 3.11, 3.12, and a Docker smoke and then enforces pass/fail in a final job. Make it required in branch protection so no one side‑steps it. Gate’s file is confirmed as .github/workflows/pr-gate.yml. 
GitHub

Acceptance criteria

Default branch protection rule requires the Gate check.

Legacy “CI” check names are not required anymore.

A test PR shows Gate as a required status and blocks merge until passing.

Task list

 Settings → Branches → default branch rule → enable “Require status checks to pass” and select Gate, enable “Require branches to be up to date.”

 Remove any old required contexts.

 Add a one‑liner to CONTRIBUTING.md: “Passing the Gate check is required to merge.”

 Validate with a draft PR that deliberately fails one job to see the block, then fix and merge.

Implementation notes

Once Issue 1 is fixed, your repo‑health check can verify this automatically. The last Gate run points to the correct workflow file and job names, so keep those stable. 
GitHub

5) Restrict or remove self‑test workflows

Labels: ci, devops

Title: Make all selftest-* workflows manual‑only; delete duplicates

Why: Self‑tests are useful when you’re designing the pipeline, not every hour for the rest of time. Your Actions list shows multiple selftest and maint-*selftest* workflows. These should be manual and quiet. 
GitHub

Acceptance criteria

All selftest-* workflows trigger only on workflow_dispatch.

No scheduled or repo‑event triggers remain for self-tests.

No self‑test runs appear unless triggered manually.

Task list

 Rename files per Issue 0 into the selftest-8X-* range.

 Remove all triggers except workflow_dispatch.

 Add a one‑paragraph note in docs/ci/WORKFLOWS.md stating they are examples and manual only.

6) Align docs with final topology and names

Labels: docs, documentation, ci, devops

Title: Refresh CI/automation docs to match final workflow set and filenames

Why: Your README and docs describe the reusable CI and the catalog; after renames and removals they need to be the source of truth so contributors don’t go spelunking. README references these docs and reusable workflows. 
GitHub

Acceptance criteria

docs/ci/WORKFLOWS.md: lists only active workflows, with final filenames, triggers, required vs optional, and permissions.

docs/WORKFLOW_GUIDE.md and docs/ci_reuse.md: show the orchestrator as the single agents entry point; no mention of agent-watchdog or the legacy consumer unless noted as deprecated.

README.md: references the renamed reusables and pr-00-gate.yml.

Task list

 Update the catalog and guide pages named above.

 Add a small diagram or table for Gate: jobs, artifacts, and the final gate enforcement job.

 Document how to manually trigger the orchestrator with a JSON input example (params_json).

 Add a troubleshooting note for the repo‑health check (what to do if the permissions aren’t sufficient).

7) Reusable agents entrypoint sanity pass

Labels: agents, ci, devops, enhancement

Title: Ensure reusable-70-agents.yml is the only callable agents entrypoint and enforce timeouts inside it

Why: The consumer currently tries to call reuse-agents.yml, which is fine, but the earlier invalid pattern was a timeout-minutes on a uses: job and calling a reusable that wasn’t declared with workflow_call. Fix the contract and centralize timeouts in the reusable. The current consumer’s error shows the call/site is wrong; this Issue ensures the callee is right. 
GitHub

Acceptance criteria

reusable-70-agents.yml declares on: workflow_call with validated inputs.

All timeouts live inside reusable-70-agents.yml per job.

Any wrapper workflows call this one reusable, not multiple variants.

Task list

 Open reusable-70-agents.yml: ensure on: workflow_call and define inputs used by the consumer.

 Add timeout-minutes: at each long‑running job inside the reusable (bootstrap, readiness, watchdog).

 Update callers to reference only reusable-70-agents.yml.

Notes on labels used
