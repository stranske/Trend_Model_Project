1) Add codex-pr-comment-command handler for branch sync
Labels: agent:codex, automation, bug
Why
Keepalive emits `codex-pr-comment-command` repository_dispatch events for "Update Branch"/"Create PR" remediation, but no workflow listens for that event type, so the commands are dropped and head advancement never happens on unattended rounds.
Tasks
- Add a small `.github/workflows` listener for `repository_dispatch` (event_type `codex-pr-comment-command`) that calls `pulls.updateBranch` with polling and, when needed, dispatches `agents-keepalive-branch-sync.yml` using the payload context instead of silently exiting.
- Ensure the handler logs or summarizes each remediation attempt (update-branch success/failure, branch-sync dispatch URL) so PR-meta can observe what happened.
- Update any keepalive tests/fixtures that assert the dispatch path to cover the new handler (e.g., `tests/fixtures/keepalive_post_work` harness expectations).
Acceptance criteria
- A repository_dispatch with `event_type: codex-pr-comment-command` triggers the automated update-branch/create-pr remediation without manual clicks and records a summary line.
- When update-branch polling fails, the same handler launches `agents-keepalive-branch-sync.yml` with the request context and surfaces the dispatched run URL.
- Keepalive post-work tests cover both the direct update-branch path and the branch-sync fallback.
Implementation notes
- Touch the keepalive post-work plumbing in `scripts/keepalive-runner.js` and add a dedicated workflow file alongside `agents-keepalive-branch-sync.yml` to process the repository_dispatch payload.

2) Pass head repository into branch-sync fallback for forks
Labels: agent:codex, automation, bug
Why
The branch-sync helper accepts a `head_repository` input so it can fetch fork heads, but keepalive never forwards the PR head repo into the fallback dispatch, causing branch-sync to default to the base repo and fail to fetch forked heads.
Tasks
- Export the PR head repository from `keepalive-prep` (or equivalent) and thread it into the keepalive post-work environment so branch-sync dispatches include `head_repository` alongside base/head refs and trace data.
- Update the branch-sync workflow invocation to honour the head repo input and bail early with a clear summary when the head repo is missing for a forked PR.
- Add tests/fixtures that exercise forked-PR branch-sync dispatches to confirm head repo propagation and checkout succeed.
Acceptance criteria
- Keepalive branch-sync dispatches include head repository metadata for forked PRs and successfully fetch the fork head during remediation.
- When head repo data is absent on a fork, the workflow emits a clear skip/failure summary instead of silently continuing with the base repo.
- Test coverage exercises the forked-PR path and asserts that the branch-sync helper clones or checks out the fork head using the forwarded repository info.
Implementation notes
- Focus on keepalive prep/post-work steps in `scripts/keepalive-runner.js` and the inputs consumed by `.github/workflows/agents-keepalive-branch-sync.yml`; avoid altering unrelated orchestrator flows.
