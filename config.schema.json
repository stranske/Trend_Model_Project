{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "additionalProperties": false,
  "default": {
    "benchmarks": {
      "spx": "SPX",
      "tsx": "TSX"
    },
    "checkpoint_dir": "outputs/checkpoints/",
    "data": {
      "allow_risk_free_fallback": false,
      "currency": "USD",
      "date_column": "Date",
      "frequency": "D",
      "indices_glob": "data/raw/indices/*.csv",
      "lookback_required": 756,
      "managers_glob": "data/raw/managers/*.csv",
      "missing_limit": null,
      "missing_policy": "ffill",
      "price_column": "Adj_Close",
      "risk_free_column": null,
      "timezone": "UTC"
    },
    "export": {
      "directory": "results/",
      "excel": {
        "autofit_columns": true,
        "conditional_bands": {
          "enabled": true,
          "palette": "RdYlGn"
        },
        "number_format": "0.00%"
      },
      "formats": [
        "xlsx",
        "csv",
        "json"
      ],
      "include_figures": false,
      "include_raw_returns": true,
      "include_vol_adj": true
    },
    "jobs": -1,
    "metrics": {
      "alpha_reference": "SP500TR",
      "bootstrap_ci": {
        "ci_level": 0.95,
        "enabled": true,
        "n_iter": 2000
      },
      "compute": [
        "CAGR",
        "Volatility",
        "Sharpe",
        "Sortino",
        "Max_Drawdown",
        "Calmar",
        "Hit_Rate",
        "Skew"
      ],
      "registry": [
        "annual_return",
        "volatility",
        "sharpe_ratio",
        "sortino_ratio",
        "information_ratio",
        "max_drawdown"
      ],
      "rf_rate_annual": 0.02,
      "use_continuous": false
    },
    "multi_period": {
      "end": "2024-12",
      "frequency": "A",
      "in_sample_len": 3,
      "max_funds": 25,
      "min_funds": 10,
      "out_sample_len": 1,
      "start": "1990-01",
      "triggers": {
        "sigma1": {
          "periods": 2,
          "sigma": 1
        },
        "sigma2": {
          "periods": 1,
          "sigma": 2
        }
      },
      "weight_curve": {
        "anchors": [
          [
            0,
            1.2
          ],
          [
            50,
            1.0
          ],
          [
            100,
            0.8
          ]
        ]
      }
    },
    "performance": {
      "cache": {
        "metrics": false
      },
      "enable_cache": true,
      "incremental_cov": false
    },
    "portfolio": {
      "ci_level": 0.0,
      "constraints": {
        "group_caps": {},
        "long_only": true,
        "max_active_positions": 0,
        "max_weight": 0.25
      },
      "cost_model": {
        "bps_per_trade": 0,
        "slippage_bps": 0
      },
      "leverage_cap": 2.0,
      "manual_list": [],
      "max_turnover": 1.0,
      "random_n": 10,
      "rank": {
        "blended_weights": {
          "AnnualReturn": 0.3,
          "MaxDrawdown": 0.2,
          "Sharpe": 0.5
        },
        "bottom_k": 0,
        "inclusion_approach": "top_n",
        "n": 10,
        "pct": 0.1,
        "score_by": "sharpe_ratio",
        "threshold": 1.5,
        "transform": "zscore"
      },
      "rebalance_calendar": "NYSE",
      "rebalance_freq": "M",
      "robustness": {
        "condition_check": {
          "diagonal_loading_factor": 1e-06,
          "enabled": true,
          "safe_mode": "hrp",
          "threshold": "1.0e12"
        },
        "logging": {
          "log_condition_numbers": true,
          "log_method_switches": true,
          "log_shrinkage_intensity": true
        },
        "shrinkage": {
          "enabled": true,
          "method": "ledoit_wolf"
        }
      },
      "selection_mode": "all",
      "selector": {
        "name": "zscore",
        "params": {
          "threshold": 1.0
        }
      },
      "transaction_cost_bps": 0,
      "weighting": {
        "name": "score_prop_bayes",
        "params": {
          "shrink_tau": 0.25
        }
      },
      "weighting_scheme": "equal"
    },
    "preprocessing": {
      "de_duplicate": true,
      "holiday_calendar": "NYSE",
      "log_prices": false,
      "missing_data": {
        "limit": null,
        "per_asset": {},
        "per_asset_limit": {},
        "policy": "drop"
      },
      "resample": {
        "business_only": true,
        "method": "last",
        "target": "D"
      },
      "winsorise": {
        "enabled": true,
        "limits": [
          0.01,
          0.99
        ]
      }
    },
    "regime": {
      "annualise_volatility": true,
      "cache": true,
      "enabled": true,
      "lookback": 126,
      "method": "rolling_return",
      "min_observations": 4,
      "neutral_band": 0.001,
      "proxy": "SPX",
      "risk_off_fund_count_multiplier": 0.5,
      "risk_off_label": "Risk-Off",
      "risk_off_target_vol_multiplier": 0.5,
      "risk_on_label": "Risk-On",
      "smoothing": 3,
      "threshold": 0.0
    },
    "run": {
      "cache_dir": ".cache/",
      "deterministic": true,
      "log_file": "logs/phase1.log",
      "log_level": "INFO",
      "n_jobs": -1
    },
    "sample_split": {
      "date": "2017-12-31",
      "folds": 5,
      "method": "date",
      "ratio": 0.7,
      "rolling_walk": false
    },
    "seed": 42,
    "version": "0.1.0",
    "vol_adjust": {
      "enabled": true,
      "floor_vol": 0.04,
      "target_vol": 0.1,
      "warmup_periods": 0,
      "window": {
        "decay": "ewma",
        "lambda": 0.94,
        "length": 63
      }
    }
  },
  "description": "Baseline schema that loaders fall back to when no config path is provided.",
  "properties": {
    "benchmarks": {
      "additionalProperties": {
        "type": "string"
      },
      "constraints": {},
      "default": {
        "spx": "SPX",
        "tsx": "TSX"
      },
      "description": "Mapping of benchmark labels to column names.",
      "nl_editable": true,
      "properties": {
        "spx": {
          "constraints": {},
          "default": "SPX",
          "description": "Example benchmark mapping for the S&P 500.",
          "nl_editable": true,
          "type": "string"
        },
        "tsx": {
          "constraints": {},
          "default": "TSX",
          "description": "Example benchmark mapping for the TSX.",
          "nl_editable": true,
          "type": "string"
        }
      },
      "type": "object"
    },
    "checkpoint_dir": {
      "constraints": {},
      "default": "outputs/checkpoints/",
      "description": "Legacy top-level checkpoint directory override.",
      "nl_editable": true,
      "type": [
        "string",
        "null"
      ]
    },
    "data": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "allow_risk_free_fallback": false,
        "currency": "USD",
        "date_column": "Date",
        "frequency": "D",
        "indices_glob": "data/raw/indices/*.csv",
        "lookback_required": 756,
        "managers_glob": "data/raw/managers/*.csv",
        "missing_limit": null,
        "missing_policy": "ffill",
        "price_column": "Adj_Close",
        "risk_free_column": null,
        "timezone": "UTC"
      },
      "description": "Data input configuration validated at startup.",
      "nl_editable": true,
      "properties": {
        "allow_risk_free_fallback": {
          "constraints": {},
          "default": false,
          "description": "Opt-in heuristic to use lowest-vol column",
          "nl_editable": true,
          "type": "boolean"
        },
        "columns": {
          "constraints": {},
          "default": null,
          "description": "Subset of columns to load from the returns CSV.",
          "nl_editable": true,
          "type": [
            "array",
            "null"
          ]
        },
        "csv_path": {
          "constraints": {},
          "default": null,
          "description": "Path to a single returns CSV file.",
          "nl_editable": false,
          "type": [
            "string",
            "null"
          ]
        },
        "currency": {
          "constraints": {},
          "default": "USD",
          "description": "Reporting currency for inputs and outputs.",
          "nl_editable": true,
          "type": "string"
        },
        "date_column": {
          "constraints": {},
          "default": "Date",
          "description": "ISO-8601 expected",
          "nl_editable": true,
          "type": "string"
        },
        "frequency": {
          "constraints": {
            "enum": [
              "D",
              "W",
              "M",
              "ME"
            ]
          },
          "default": "D",
          "description": "D | W | M",
          "enum": [
            "D",
            "W",
            "M",
            "ME"
          ],
          "nl_editable": true,
          "type": "string"
        },
        "indices_glob": {
          "constraints": {},
          "default": "data/raw/indices/*.csv",
          "description": "Glob for benchmark index CSV inputs.",
          "nl_editable": false,
          "type": [
            "string",
            "null"
          ]
        },
        "lookback_required": {
          "constraints": {},
          "default": 756,
          "description": "minimum obs (~3 yrs daily)",
          "nl_editable": true,
          "type": "integer"
        },
        "managers_glob": {
          "constraints": {},
          "default": "data/raw/managers/*.csv",
          "description": "Glob for manager return CSV inputs.",
          "nl_editable": false,
          "type": [
            "string",
            "null"
          ]
        },
        "missing_fill_limit": {
          "constraints": {},
          "default": null,
          "description": "Maximum consecutive periods to forward-fill missing data.",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        },
        "missing_limit": {
          "constraints": {},
          "default": null,
          "description": "Optional int (per-column overrides supported)",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        },
        "missing_policy": {
          "constraints": {
            "enum": [
              "drop",
              "ffill",
              "zero"
            ]
          },
          "default": "ffill",
          "description": "drop | ffill | zero",
          "enum": [
            "drop",
            "ffill",
            "zero"
          ],
          "nl_editable": true,
          "type": "string"
        },
        "na_as_zero": {
          "additionalProperties": false,
          "constraints": {},
          "default": null,
          "description": "Config option for data.na_as_zero.",
          "nl_editable": true,
          "properties": {
            "enabled": {
              "constraints": {},
              "default": true,
              "description": "Config option for data.na_as_zero.enabled.",
              "nl_editable": true,
              "type": "boolean"
            },
            "max_consecutive_gap": {
              "constraints": {},
              "default": 1,
              "description": "Config option for data.na_as_zero.max_consecutive_gap.",
              "nl_editable": true,
              "type": "integer"
            },
            "max_missing_per_window": {
              "constraints": {},
              "default": 1,
              "description": "Config option for data.na_as_zero.max_missing_per_window.",
              "nl_editable": true,
              "type": "integer"
            }
          },
          "type": [
            "null",
            "object"
          ]
        },
        "price_column": {
          "constraints": {},
          "default": "Adj_Close",
          "description": "or \"NAV\", etc.",
          "nl_editable": true,
          "type": "string"
        },
        "risk_free_column": {
          "constraints": {},
          "default": null,
          "description": "Explicit risk-free series name when present",
          "nl_editable": true,
          "type": [
            "string",
            "null"
          ]
        },
        "timezone": {
          "constraints": {},
          "default": "UTC",
          "description": "for parsing",
          "nl_editable": true,
          "type": "string"
        },
        "universe_membership_path": {
          "constraints": {},
          "default": null,
          "description": "Optional CSV with universe membership overrides.",
          "nl_editable": false,
          "type": [
            "string",
            "null"
          ]
        }
      },
      "type": "object"
    },
    "export": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "directory": "results/",
        "excel": {
          "autofit_columns": true,
          "conditional_bands": {
            "enabled": true,
            "palette": "RdYlGn"
          },
          "number_format": "0.00%"
        },
        "formats": [
          "xlsx",
          "csv",
          "json"
        ],
        "include_figures": false,
        "include_raw_returns": true,
        "include_vol_adj": true
      },
      "description": "Export settings for output artifacts.",
      "nl_editable": true,
      "properties": {
        "directory": {
          "constraints": {},
          "default": "results/",
          "description": "Directory to write export outputs.",
          "nl_editable": false,
          "type": "string"
        },
        "excel": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "autofit_columns": true,
            "conditional_bands": {
              "enabled": true,
              "palette": "RdYlGn"
            },
            "number_format": "0.00%"
          },
          "description": "Excel-specific export settings.",
          "nl_editable": true,
          "properties": {
            "autofit_columns": {
              "constraints": {},
              "default": true,
              "description": "Auto size Excel columns to fit content.",
              "nl_editable": true,
              "type": "boolean"
            },
            "conditional_bands": {
              "additionalProperties": false,
              "constraints": {},
              "default": {
                "enabled": true,
                "palette": "RdYlGn"
              },
              "description": "Conditional formatting bands for Excel exports.",
              "nl_editable": true,
              "properties": {
                "enabled": {
                  "constraints": {},
                  "default": true,
                  "description": "Enable conditional formatting bands in Excel.",
                  "nl_editable": true,
                  "type": "boolean"
                },
                "palette": {
                  "constraints": {},
                  "default": "RdYlGn",
                  "description": "Color palette name for Excel conditional bands.",
                  "nl_editable": true,
                  "type": "string"
                }
              },
              "type": "object"
            },
            "number_format": {
              "constraints": {},
              "default": "0.00%",
              "description": "Default numeric format for Excel output.",
              "nl_editable": true,
              "type": "string"
            }
          },
          "type": "object"
        },
        "filename": {
          "constraints": {},
          "default": null,
          "description": "Config option for export.filename.",
          "nl_editable": false,
          "type": [
            "null",
            "string"
          ]
        },
        "formats": {
          "constraints": {},
          "default": [
            "xlsx",
            "csv",
            "json"
          ],
          "description": "List of export formats to write.",
          "items": {
            "type": "string"
          },
          "nl_editable": true,
          "type": "array"
        },
        "include_figures": {
          "constraints": {},
          "default": false,
          "description": "Phase-2",
          "nl_editable": true,
          "type": "boolean"
        },
        "include_raw_returns": {
          "constraints": {},
          "default": true,
          "description": "Include raw return series in exports.",
          "nl_editable": true,
          "type": "boolean"
        },
        "include_vol_adj": {
          "constraints": {},
          "default": true,
          "description": "Include volatility-adjusted series in exports.",
          "nl_editable": true,
          "type": "boolean"
        }
      },
      "type": "object"
    },
    "jobs": {
      "constraints": {},
      "default": -1,
      "description": "-1 = use all logical cores",
      "nl_editable": true,
      "type": [
        "integer",
        "null"
      ]
    },
    "metrics": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "alpha_reference": "SP500TR",
        "bootstrap_ci": {
          "ci_level": 0.95,
          "enabled": true,
          "n_iter": 2000
        },
        "compute": [
          "CAGR",
          "Volatility",
          "Sharpe",
          "Sortino",
          "Max_Drawdown",
          "Calmar",
          "Hit_Rate",
          "Skew"
        ],
        "registry": [
          "annual_return",
          "volatility",
          "sharpe_ratio",
          "sortino_ratio",
          "information_ratio",
          "max_drawdown"
        ],
        "rf_rate_annual": 0.02,
        "use_continuous": false
      },
      "description": "Performance metrics configuration.",
      "nl_editable": true,
      "properties": {
        "alpha_reference": {
          "constraints": {},
          "default": "SP500TR",
          "description": "ticker in indices_glob",
          "nl_editable": true,
          "type": "string"
        },
        "bootstrap_ci": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "ci_level": 0.95,
            "enabled": true,
            "n_iter": 2000
          },
          "description": "Bootstrap confidence interval settings.",
          "nl_editable": true,
          "properties": {
            "ci_level": {
              "constraints": {
                "maximum": 1,
                "minimum": 0
              },
              "default": 0.95,
              "description": "Bootstrap confidence level.",
              "maximum": 1,
              "minimum": 0,
              "nl_editable": true,
              "type": "number"
            },
            "enabled": {
              "constraints": {},
              "default": true,
              "description": "Enable bootstrap confidence intervals.",
              "nl_editable": true,
              "type": "boolean"
            },
            "n_iter": {
              "constraints": {},
              "default": 2000,
              "description": "Number of bootstrap iterations.",
              "nl_editable": true,
              "type": "integer"
            }
          },
          "type": "object"
        },
        "compute": {
          "constraints": {},
          "default": [
            "CAGR",
            "Volatility",
            "Sharpe",
            "Sortino",
            "Max_Drawdown",
            "Calmar",
            "Hit_Rate",
            "Skew"
          ],
          "description": "Legacy metrics list for reporting exports.",
          "items": {
            "type": "string"
          },
          "nl_editable": true,
          "type": "array"
        },
        "drawdown": {
          "constraints": {},
          "default": null,
          "description": "Config option for metrics.drawdown.",
          "nl_editable": true,
          "type": [
            "null",
            "number"
          ]
        },
        "max_drawdown": {
          "constraints": {},
          "default": null,
          "description": "Config option for metrics.max_drawdown.",
          "nl_editable": true,
          "type": [
            "null",
            "number"
          ]
        },
        "registry": {
          "constraints": {},
          "default": [
            "annual_return",
            "volatility",
            "sharpe_ratio",
            "sortino_ratio",
            "information_ratio",
            "max_drawdown"
          ],
          "description": "Metric registry identifiers for score frame.",
          "items": {
            "type": "string"
          },
          "nl_editable": true,
          "type": "array"
        },
        "return_ann": {
          "constraints": {},
          "default": null,
          "description": "Config option for metrics.return_ann.",
          "nl_editable": true,
          "type": [
            "null",
            "number"
          ]
        },
        "rf_rate_annual": {
          "constraints": {
            "minimum": 0
          },
          "default": 0.02,
          "description": "flat rf or link to series",
          "minimum": 0,
          "nl_editable": true,
          "type": "number"
        },
        "sharpe": {
          "constraints": {},
          "default": null,
          "description": "Config option for metrics.sharpe.",
          "nl_editable": true,
          "type": [
            "null",
            "number"
          ]
        },
        "sharpe_ratio": {
          "constraints": {},
          "default": null,
          "description": "Config option for metrics.sharpe_ratio.",
          "nl_editable": true,
          "type": [
            "null",
            "number"
          ]
        },
        "use_continuous": {
          "constraints": {},
          "default": false,
          "description": "geometric (default) vs. log",
          "nl_editable": true,
          "type": "boolean"
        },
        "volatility": {
          "constraints": {},
          "default": null,
          "description": "Config option for metrics.volatility.",
          "nl_editable": true,
          "type": [
            "null",
            "number"
          ]
        }
      },
      "type": "object"
    },
    "multi_period": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "end": "2024-12",
        "frequency": "A",
        "in_sample_len": 3,
        "max_funds": 25,
        "min_funds": 10,
        "out_sample_len": 1,
        "start": "1990-01",
        "triggers": {
          "sigma1": {
            "periods": 2,
            "sigma": 1
          },
          "sigma2": {
            "periods": 1,
            "sigma": 2
          }
        },
        "weight_curve": {
          "anchors": [
            [
              0,
              1.2
            ],
            [
              50,
              1.0
            ],
            [
              100,
              0.8
            ]
          ]
        }
      },
      "description": "Multi-period run configuration.",
      "nl_editable": true,
      "properties": {
        "end": {
          "constraints": {},
          "default": "2024-12",
          "description": "End period for multi-period runs.",
          "nl_editable": true,
          "type": "string"
        },
        "frequency": {
          "constraints": {},
          "default": "A",
          "description": "M | Q | A (Monthly, Quarterly, Annual)",
          "nl_editable": true,
          "type": "string"
        },
        "in_sample_len": {
          "constraints": {},
          "default": 3,
          "description": "rolling windows",
          "nl_editable": true,
          "type": "integer"
        },
        "max_funds": {
          "constraints": {},
          "default": 25,
          "description": "Maximum funds selected in multi-period runs.",
          "nl_editable": true,
          "type": "integer"
        },
        "min_funds": {
          "constraints": {},
          "default": 10,
          "description": "Minimum funds required in multi-period runs.",
          "nl_editable": true,
          "type": "integer"
        },
        "out_sample_len": {
          "constraints": {},
          "default": 1,
          "description": "Length of the out-of-sample window.",
          "nl_editable": true,
          "type": "integer"
        },
        "start": {
          "constraints": {},
          "default": "1990-01",
          "description": "Start period for multi-period runs.",
          "nl_editable": true,
          "type": "string"
        },
        "triggers": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "sigma1": {
              "periods": 2,
              "sigma": 1
            },
            "sigma2": {
              "periods": 1,
              "sigma": 2
            }
          },
          "description": "Trigger definitions for multi-period rebalances.",
          "nl_editable": true,
          "properties": {
            "sigma1": {
              "additionalProperties": false,
              "constraints": {},
              "default": {
                "periods": 2,
                "sigma": 1
              },
              "description": "Trigger configuration for 1-sigma events.",
              "nl_editable": true,
              "properties": {
                "periods": {
                  "constraints": {},
                  "default": 2,
                  "description": "Consecutive periods required for sigma1 trigger.",
                  "nl_editable": true,
                  "type": "integer"
                },
                "sigma": {
                  "constraints": {},
                  "default": 1,
                  "description": "Sigma threshold for sigma1 trigger.",
                  "nl_editable": true,
                  "type": "integer"
                }
              },
              "type": "object"
            },
            "sigma2": {
              "additionalProperties": false,
              "constraints": {},
              "default": {
                "periods": 1,
                "sigma": 2
              },
              "description": "Trigger configuration for 2-sigma events.",
              "nl_editable": true,
              "properties": {
                "periods": {
                  "constraints": {},
                  "default": 1,
                  "description": "Consecutive periods required for sigma2 trigger.",
                  "nl_editable": true,
                  "type": "integer"
                },
                "sigma": {
                  "constraints": {},
                  "default": 2,
                  "description": "Sigma threshold for sigma2 trigger.",
                  "nl_editable": true,
                  "type": "integer"
                }
              },
              "type": "object"
            }
          },
          "type": "object"
        },
        "weight_curve": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "anchors": [
              [
                0,
                1.2
              ],
              [
                50,
                1.0
              ],
              [
                100,
                0.8
              ]
            ]
          },
          "description": "Weight curve adjustments by rank.",
          "nl_editable": true,
          "properties": {
            "anchors": {
              "constraints": {},
              "default": [
                [
                  0,
                  1.2
                ],
                [
                  50,
                  1.0
                ],
                [
                  100,
                  0.8
                ]
              ],
              "description": "[rankpercentile, multiplier]",
              "items": {
                "type": "array"
              },
              "nl_editable": true,
              "type": "array"
            }
          },
          "type": "object"
        }
      },
      "type": "object"
    },
    "performance": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "cache": {
          "metrics": false
        },
        "enable_cache": true,
        "incremental_cov": false
      },
      "description": "Performance cache and timing settings.",
      "nl_editable": true,
      "properties": {
        "cache": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "metrics": false
          },
          "description": "Performance cache controls.",
          "nl_editable": true,
          "properties": {
            "metrics": {
              "constraints": {},
              "default": false,
              "description": "scalar metric series memoization (Issue #1156)",
              "nl_editable": true,
              "type": "boolean"
            }
          },
          "type": "object"
        },
        "enable_cache": {
          "constraints": {},
          "default": true,
          "description": "Enable performance cache.",
          "nl_editable": true,
          "type": "boolean"
        },
        "incremental_cov": {
          "constraints": {},
          "default": false,
          "description": "Enable incremental covariance updates.",
          "nl_editable": true,
          "type": "boolean"
        }
      },
      "type": "object"
    },
    "portfolio": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "ci_level": 0.0,
        "constraints": {
          "group_caps": {},
          "long_only": true,
          "max_active_positions": 0,
          "max_weight": 0.25
        },
        "cost_model": {
          "bps_per_trade": 0,
          "slippage_bps": 0
        },
        "leverage_cap": 2.0,
        "manual_list": [],
        "max_turnover": 1.0,
        "random_n": 10,
        "rank": {
          "blended_weights": {
            "AnnualReturn": 0.3,
            "MaxDrawdown": 0.2,
            "Sharpe": 0.5
          },
          "bottom_k": 0,
          "inclusion_approach": "top_n",
          "n": 10,
          "pct": 0.1,
          "score_by": "sharpe_ratio",
          "threshold": 1.5,
          "transform": "zscore"
        },
        "rebalance_calendar": "NYSE",
        "rebalance_freq": "M",
        "robustness": {
          "condition_check": {
            "diagonal_loading_factor": 1e-06,
            "enabled": true,
            "safe_mode": "hrp",
            "threshold": "1.0e12"
          },
          "logging": {
            "log_condition_numbers": true,
            "log_method_switches": true,
            "log_shrinkage_intensity": true
          },
          "shrinkage": {
            "enabled": true,
            "method": "ledoit_wolf"
          }
        },
        "selection_mode": "all",
        "selector": {
          "name": "zscore",
          "params": {
            "threshold": 1.0
          }
        },
        "transaction_cost_bps": 0,
        "weighting": {
          "name": "score_prop_bayes",
          "params": {
            "shrink_tau": 0.25
          }
        },
        "weighting_scheme": "equal"
      },
      "description": "Portfolio controls validated before running analyses.",
      "nl_editable": true,
      "properties": {
        "ci_level": {
          "constraints": {},
          "default": 0.0,
          "description": "reporting-only confidence interval (0 disables)",
          "nl_editable": true,
          "type": "number"
        },
        "constraints": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "group_caps": {},
            "long_only": true,
            "max_active_positions": 0,
            "max_weight": 0.25
          },
          "description": "Portfolio constraint settings.",
          "nl_editable": true,
          "properties": {
            "cash_weight": {
              "constraints": {},
              "default": null,
              "description": "Config option for portfolio.constraints.cash_weight.",
              "nl_editable": true,
              "type": [
                "null",
                "number"
              ]
            },
            "group_caps": {
              "additionalProperties": {
                "type": "number"
              },
              "constraints": {},
              "default": {},
              "description": "Group-level exposure caps by tag.",
              "nl_editable": true,
              "properties": {
                "Macro": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.constraints.group_caps.Macro.",
                  "nl_editable": true,
                  "type": [
                    "null",
                    "number"
                  ]
                },
                "Trend": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.constraints.group_caps.Trend.",
                  "nl_editable": true,
                  "type": [
                    "null",
                    "number"
                  ]
                }
              },
              "type": "object"
            },
            "groups": {
              "additionalProperties": false,
              "constraints": {},
              "default": null,
              "description": "Config option for portfolio.constraints.groups.",
              "nl_editable": true,
              "properties": {
                "FundA": {
                  "constraints": {},
                  "default": "Trend",
                  "description": "Config option for portfolio.constraints.groups.FundA.",
                  "nl_editable": true,
                  "type": "string"
                },
                "FundB": {
                  "constraints": {},
                  "default": "Trend",
                  "description": "Config option for portfolio.constraints.groups.FundB.",
                  "nl_editable": true,
                  "type": "string"
                },
                "FundC": {
                  "constraints": {},
                  "default": "Macro",
                  "description": "Config option for portfolio.constraints.groups.FundC.",
                  "nl_editable": true,
                  "type": "string"
                },
                "FundD": {
                  "constraints": {},
                  "default": "Macro",
                  "description": "Config option for portfolio.constraints.groups.FundD.",
                  "nl_editable": true,
                  "type": "string"
                }
              },
              "type": [
                "null",
                "object"
              ]
            },
            "long_only": {
              "constraints": {},
              "default": true,
              "description": "Enforce long-only allocations.",
              "nl_editable": true,
              "type": "boolean"
            },
            "max_active_positions": {
              "constraints": {},
              "default": 0,
              "description": "Maximum number of active positions.",
              "nl_editable": true,
              "type": "integer"
            },
            "max_weight": {
              "constraints": {
                "maximum": 1,
                "minimum": 0
              },
              "default": 0.25,
              "description": "Maximum weight per position.",
              "maximum": 1,
              "minimum": 0,
              "nl_editable": true,
              "type": "number"
            }
          },
          "type": "object"
        },
        "cooldown_months": {
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.cooldown_months.",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        },
        "cost_model": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "bps_per_trade": 0,
            "slippage_bps": 0
          },
          "description": "Transaction cost model settings.",
          "nl_editable": true,
          "properties": {
            "bps_per_trade": {
              "constraints": {},
              "default": 0,
              "description": "overrides transaction_cost_bps when provided",
              "nl_editable": true,
              "type": "integer"
            },
            "slippage_bps": {
              "constraints": {},
              "default": 0,
              "description": "additional penalty applied on turnover",
              "nl_editable": true,
              "type": "integer"
            }
          },
          "type": "object"
        },
        "custom_weights": {
          "additionalProperties": {
            "type": "number"
          },
          "constraints": {},
          "default": null,
          "description": "Explicit weight overrides keyed by manager name.",
          "nl_editable": true,
          "properties": {
            "Mgr_01": {
              "constraints": {},
              "default": 60,
              "description": "Config option for portfolio.custom_weights.Mgr_01.",
              "nl_editable": true,
              "type": "integer"
            },
            "Mgr_02": {
              "constraints": {},
              "default": 40,
              "description": "Config option for portfolio.custom_weights.Mgr_02.",
              "nl_editable": true,
              "type": "integer"
            }
          },
          "type": [
            "null",
            "object"
          ]
        },
        "entry_eligible_strikes": {
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.entry_eligible_strikes.",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        },
        "entry_soft_strikes": {
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.entry_soft_strikes.",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        },
        "indices_list": {
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.indices_list.",
          "nl_editable": true,
          "type": [
            "array",
            "null"
          ]
        },
        "leverage_cap": {
          "constraints": {
            "minimum": 0
          },
          "default": 2.0,
          "description": "max gross exposure",
          "minimum": 0,
          "nl_editable": true,
          "type": "number"
        },
        "manual_list": {
          "constraints": {},
          "default": [],
          "description": "filled when selection_mode=manual",
          "items": {
            "type": "string"
          },
          "nl_editable": true,
          "type": "array"
        },
        "max_turnover": {
          "constraints": {
            "maximum": 2,
            "minimum": 0
          },
          "default": 1.0,
          "description": "optional turnover cap (1.0 = no cap)",
          "maximum": 2,
          "minimum": 0,
          "nl_editable": true,
          "type": [
            "number",
            "null"
          ]
        },
        "max_weight": {
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.max_weight.",
          "nl_editable": true,
          "type": [
            "null",
            "number"
          ]
        },
        "policy": {
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.policy.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "random_n": {
          "constraints": {},
          "default": 10,
          "description": "num managers if random",
          "nl_editable": true,
          "type": "integer"
        },
        "rank": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "blended_weights": {
              "AnnualReturn": 0.3,
              "MaxDrawdown": 0.2,
              "Sharpe": 0.5
            },
            "bottom_k": 0,
            "inclusion_approach": "top_n",
            "n": 10,
            "pct": 0.1,
            "score_by": "sharpe_ratio",
            "threshold": 1.5,
            "transform": "zscore"
          },
          "description": "Ranking-based selection settings.",
          "nl_editable": true,
          "properties": {
            "blended_weights": {
              "additionalProperties": {
                "type": "number"
              },
              "constraints": {},
              "default": {
                "AnnualReturn": 0.3,
                "MaxDrawdown": 0.2,
                "Sharpe": 0.5
              },
              "description": "Weights for blended rank scoring.",
              "nl_editable": true,
              "properties": {
                "AnnualReturn": {
                  "constraints": {},
                  "default": 0.3,
                  "description": "Weight for annual return in blended score.",
                  "nl_editable": true,
                  "type": "number"
                },
                "MaxDrawdown": {
                  "constraints": {},
                  "default": 0.2,
                  "description": "Weight for max drawdown in blended score.",
                  "nl_editable": true,
                  "type": "number"
                },
                "Sharpe": {
                  "constraints": {},
                  "default": 0.5,
                  "description": "Weight for Sharpe ratio in blended score.",
                  "nl_editable": true,
                  "type": "number"
                }
              },
              "type": "object"
            },
            "bottom_k": {
              "constraints": {},
              "default": 0,
              "description": "exclude worst-performing K funds",
              "nl_editable": true,
              "type": "integer"
            },
            "inclusion_approach": {
              "constraints": {
                "enum": [
                  "top_n",
                  "top_pct",
                  "threshold"
                ]
              },
              "default": "top_n",
              "description": "top_n | top_pct | threshold",
              "enum": [
                "top_n",
                "top_pct",
                "threshold"
              ],
              "nl_editable": true,
              "type": "string"
            },
            "limit_one_per_firm": {
              "constraints": {},
              "default": null,
              "description": "Config option for portfolio.rank.limit_one_per_firm.",
              "nl_editable": true,
              "type": [
                "boolean",
                "null"
              ]
            },
            "n": {
              "constraints": {},
              "default": 10,
              "description": "for top_n",
              "nl_editable": true,
              "type": "integer"
            },
            "pct": {
              "constraints": {},
              "default": 0.1,
              "description": "for top_pct (decimal, not %)",
              "nl_editable": true,
              "type": [
                "number",
                "null"
              ]
            },
            "score_by": {
              "constraints": {},
              "default": "sharpe_ratio",
              "description": "Sharpe | AnnualReturn |  | blended",
              "nl_editable": true,
              "type": "string"
            },
            "threshold": {
              "constraints": {},
              "default": 1.5,
              "description": "ignored unless approach == threshold",
              "nl_editable": true,
              "type": [
                "number",
                "null"
              ]
            },
            "transform": {
              "constraints": {},
              "default": "zscore",
              "description": "Transform applied to ranking scores.",
              "nl_editable": true,
              "type": "string"
            }
          },
          "type": "object"
        },
        "rebalance_calendar": {
          "constraints": {},
          "default": "NYSE",
          "description": "Trading calendar for rebalance dates.",
          "nl_editable": true,
          "type": "string"
        },
        "rebalance_freq": {
          "constraints": {
            "enum": [
              "M",
              "Q",
              "A",
              null
            ]
          },
          "default": "M",
          "description": "M | Q | A | None",
          "enum": [
            "M",
            "Q",
            "A",
            null
          ],
          "nl_editable": true,
          "type": [
            "string",
            "null"
          ]
        },
        "robustness": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "condition_check": {
              "diagonal_loading_factor": 1e-06,
              "enabled": true,
              "safe_mode": "hrp",
              "threshold": "1.0e12"
            },
            "logging": {
              "log_condition_numbers": true,
              "log_method_switches": true,
              "log_shrinkage_intensity": true
            },
            "shrinkage": {
              "enabled": true,
              "method": "ledoit_wolf"
            }
          },
          "description": "Robust covariance settings.",
          "nl_editable": true,
          "properties": {
            "condition_check": {
              "additionalProperties": false,
              "constraints": {},
              "default": {
                "diagonal_loading_factor": 1e-06,
                "enabled": true,
                "safe_mode": "hrp",
                "threshold": "1.0e12"
              },
              "description": "Condition-number monitoring settings.",
              "nl_editable": true,
              "properties": {
                "diagonal_loading_factor": {
                  "constraints": {},
                  "default": 1e-06,
                  "description": "for diagonal loading regularization",
                  "nl_editable": true,
                  "type": "number"
                },
                "enabled": {
                  "constraints": {},
                  "default": true,
                  "description": "Enable condition number checks.",
                  "nl_editable": true,
                  "type": "boolean"
                },
                "safe_mode": {
                  "constraints": {},
                  "default": "hrp",
                  "description": "hrp | risk_parity | diagonal_mv",
                  "nl_editable": true,
                  "type": "string"
                },
                "threshold": {
                  "constraints": {},
                  "default": "1.0e12",
                  "description": "maximum allowed condition number",
                  "nl_editable": true,
                  "type": "string"
                }
              },
              "type": "object"
            },
            "logging": {
              "additionalProperties": false,
              "constraints": {},
              "default": {
                "log_condition_numbers": true,
                "log_method_switches": true,
                "log_shrinkage_intensity": true
              },
              "description": "Logging settings for robustness decisions.",
              "nl_editable": true,
              "properties": {
                "log_condition_numbers": {
                  "constraints": {},
                  "default": true,
                  "description": "log matrix condition numbers",
                  "nl_editable": true,
                  "type": "boolean"
                },
                "log_method_switches": {
                  "constraints": {},
                  "default": true,
                  "description": "log when switching to safe mode",
                  "nl_editable": true,
                  "type": "boolean"
                },
                "log_shrinkage_intensity": {
                  "constraints": {},
                  "default": true,
                  "description": "log shrinkage parameters",
                  "nl_editable": true,
                  "type": "boolean"
                }
              },
              "type": "object"
            },
            "shrinkage": {
              "additionalProperties": false,
              "constraints": {},
              "default": {
                "enabled": true,
                "method": "ledoit_wolf"
              },
              "description": "Covariance shrinkage settings.",
              "nl_editable": true,
              "properties": {
                "enabled": {
                  "constraints": {},
                  "default": true,
                  "description": "Enable covariance shrinkage.",
                  "nl_editable": true,
                  "type": "boolean"
                },
                "method": {
                  "constraints": {},
                  "default": "ledoit_wolf",
                  "description": "none | ledoit_wolf | oas",
                  "nl_editable": true,
                  "type": "string"
                }
              },
              "type": "object"
            }
          },
          "type": "object"
        },
        "selection_mode": {
          "constraints": {
            "enum": [
              "all",
              "random",
              "manual",
              "rank"
            ]
          },
          "default": "all",
          "description": "all | random | manual",
          "enum": [
            "all",
            "random",
            "manual",
            "rank"
          ],
          "nl_editable": true,
          "type": "string"
        },
        "selector": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "name": "zscore",
            "params": {
              "threshold": 1.0
            }
          },
          "description": "Selector plugin settings.",
          "nl_editable": true,
          "properties": {
            "name": {
              "constraints": {},
              "default": "zscore",
              "description": "or 'rank'",
              "nl_editable": true,
              "type": "string"
            },
            "params": {
              "additionalProperties": {
                "type": [
                  "number",
                  "string",
                  "boolean",
                  "array",
                  "object",
                  "null"
                ]
              },
              "constraints": {},
              "default": {
                "threshold": 1.0
              },
              "description": "Parameters for selector plugin.",
              "nl_editable": true,
              "properties": {
                "rank_column": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.selector.params.rank_column.",
                  "nl_editable": true,
                  "type": [
                    "null",
                    "string"
                  ]
                },
                "threshold": {
                  "constraints": {},
                  "default": 1.0,
                  "description": "",
                  "nl_editable": true,
                  "type": "number"
                },
                "top_n": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.selector.params.top_n.",
                  "nl_editable": true,
                  "type": [
                    "integer",
                    "null"
                  ]
                }
              },
              "type": "object"
            }
          },
          "type": "object"
        },
        "target_n": {
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.target_n.",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        },
        "threshold_hold": {
          "additionalProperties": false,
          "constraints": {},
          "default": null,
          "description": "Config option for portfolio.threshold_hold.",
          "nl_editable": true,
          "properties": {
            "metric": {
              "constraints": {},
              "default": "Sharpe",
              "description": "Config option for portfolio.threshold_hold.metric.",
              "nl_editable": true,
              "type": "string"
            },
            "soft_strikes": {
              "constraints": {},
              "default": 2,
              "description": "Config option for portfolio.threshold_hold.soft_strikes.",
              "nl_editable": true,
              "type": "integer"
            },
            "target_n": {
              "constraints": {},
              "default": 8,
              "description": "Config option for portfolio.threshold_hold.target_n.",
              "nl_editable": true,
              "type": "integer"
            },
            "weighting": {
              "constraints": {},
              "default": "score_prop_bayes",
              "description": "Config option for portfolio.threshold_hold.weighting.",
              "nl_editable": true,
              "type": "string"
            },
            "z_entry_hard": {
              "constraints": {},
              "default": 1.5,
              "description": "Config option for portfolio.threshold_hold.z_entry_hard.",
              "nl_editable": true,
              "type": "number"
            },
            "z_entry_soft": {
              "constraints": {},
              "default": 1.0,
              "description": "Config option for portfolio.threshold_hold.z_entry_soft.",
              "nl_editable": true,
              "type": "number"
            },
            "z_exit_hard": {
              "constraints": {},
              "default": -1.5,
              "description": "Config option for portfolio.threshold_hold.z_exit_hard.",
              "nl_editable": true,
              "type": "number"
            },
            "z_exit_soft": {
              "constraints": {},
              "default": -1.0,
              "description": "Config option for portfolio.threshold_hold.z_exit_soft.",
              "nl_editable": true,
              "type": "number"
            }
          },
          "type": [
            "null",
            "object"
          ]
        },
        "transaction_cost_bps": {
          "constraints": {
            "minimum": 0
          },
          "default": 0,
          "description": "linear cost per unit turnover",
          "minimum": 0,
          "nl_editable": true,
          "type": "integer"
        },
        "weighting": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "name": "score_prop_bayes",
            "params": {
              "shrink_tau": 0.25
            }
          },
          "description": "Weighting plugin settings.",
          "nl_editable": true,
          "properties": {
            "name": {
              "constraints": {},
              "default": "score_prop_bayes",
              "description": "Weighting plugin name.",
              "nl_editable": true,
              "type": "string"
            },
            "params": {
              "additionalProperties": {
                "type": [
                  "number",
                  "string",
                  "boolean",
                  "array",
                  "object",
                  "null"
                ]
              },
              "constraints": {},
              "default": {
                "shrink_tau": 0.25
              },
              "description": "Parameters for weighting plugin.",
              "nl_editable": true,
              "properties": {
                "condition_threshold": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.weighting.params.condition_threshold.",
                  "nl_editable": true,
                  "type": [
                    "null",
                    "string"
                  ]
                },
                "diagonal_loading_factor": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.weighting.params.diagonal_loading_factor.",
                  "nl_editable": true,
                  "type": [
                    "null",
                    "number"
                  ]
                },
                "safe_mode": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.weighting.params.safe_mode.",
                  "nl_editable": true,
                  "type": [
                    "null",
                    "string"
                  ]
                },
                "shrink_tau": {
                  "constraints": {},
                  "default": 0.25,
                  "description": "Shrinkage tau for Bayesian weighting.",
                  "nl_editable": true,
                  "type": "number"
                },
                "shrinkage_method": {
                  "constraints": {},
                  "default": null,
                  "description": "Config option for portfolio.weighting.params.shrinkage_method.",
                  "nl_editable": true,
                  "type": [
                    "null",
                    "string"
                  ]
                }
              },
              "type": "object"
            }
          },
          "type": "object"
        },
        "weighting_scheme": {
          "constraints": {
            "enum": [
              "equal",
              "risk_parity",
              "hrp",
              "erc",
              "robust_mv",
              "robust_risk_parity",
              "custom"
            ]
          },
          "default": "equal",
          "description": "equal | risk_parity | hrp | erc | robust_mv | robust_risk_parity | custom",
          "enum": [
            "equal",
            "risk_parity",
            "hrp",
            "erc",
            "robust_mv",
            "robust_risk_parity",
            "custom"
          ],
          "nl_editable": true,
          "type": "string"
        }
      },
      "type": "object"
    },
    "preprocessing": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "de_duplicate": true,
        "holiday_calendar": "NYSE",
        "log_prices": false,
        "missing_data": {
          "limit": null,
          "per_asset": {},
          "per_asset_limit": {},
          "policy": "drop"
        },
        "resample": {
          "business_only": true,
          "method": "last",
          "target": "D"
        },
        "winsorise": {
          "enabled": true,
          "limits": [
            0.01,
            0.99
          ]
        }
      },
      "description": "Preprocessing settings.",
      "nl_editable": true,
      "properties": {
        "de_duplicate": {
          "constraints": {},
          "default": true,
          "description": "Drop duplicate timestamps or rows.",
          "nl_editable": true,
          "type": "boolean"
        },
        "holiday_calendar": {
          "constraints": {},
          "default": "NYSE",
          "description": "forward fill non-trading days",
          "nl_editable": true,
          "type": "string"
        },
        "log_prices": {
          "constraints": {},
          "default": false,
          "description": "turn on if prices span decades",
          "nl_editable": true,
          "type": "boolean"
        },
        "missing_data": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "limit": null,
            "per_asset": {},
            "per_asset_limit": {},
            "policy": "drop"
          },
          "description": "Missing data handling settings.",
          "nl_editable": true,
          "properties": {
            "limit": {
              "constraints": {},
              "default": null,
              "description": "max consecutive periods to forward-fill (None = unlimited)",
              "nl_editable": true,
              "type": [
                "integer",
                "null"
              ]
            },
            "per_asset": {
              "additionalProperties": {
                "type": "string"
              },
              "constraints": {},
              "default": {},
              "description": "optional overrides, e.g. {RF: zero}",
              "nl_editable": true,
              "properties": {},
              "type": "object"
            },
            "per_asset_limit": {
              "additionalProperties": {
                "type": [
                  "integer",
                  "null"
                ]
              },
              "constraints": {},
              "default": {},
              "description": "optional forward-fill window overrides per asset",
              "nl_editable": true,
              "properties": {},
              "type": "object"
            },
            "policy": {
              "constraints": {
                "enum": [
                  "drop",
                  "ffill",
                  "zero"
                ]
              },
              "default": "drop",
              "description": "drop | ffill | zero",
              "enum": [
                "drop",
                "ffill",
                "zero"
              ],
              "nl_editable": true,
              "type": "string"
            }
          },
          "type": "object"
        },
        "resample": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "business_only": true,
            "method": "last",
            "target": "D"
          },
          "description": "Resampling settings.",
          "nl_editable": true,
          "properties": {
            "business_only": {
              "constraints": {},
              "default": true,
              "description": "Resample on business days only.",
              "nl_editable": true,
              "type": "boolean"
            },
            "method": {
              "constraints": {
                "enum": [
                  "last",
                  "mean",
                  "sum",
                  "pad"
                ]
              },
              "default": "last",
              "description": "last | mean | sum | pad",
              "enum": [
                "last",
                "mean",
                "sum",
                "pad"
              ],
              "nl_editable": true,
              "type": "string"
            },
            "target": {
              "constraints": {},
              "default": "D",
              "description": "keep None to skip",
              "nl_editable": true,
              "type": [
                "string",
                "null"
              ]
            }
          },
          "type": "object"
        },
        "steps": {
          "constraints": {},
          "default": null,
          "description": "Optional list of preprocessing steps to run in order.",
          "nl_editable": true,
          "type": "null"
        },
        "winsorise": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "enabled": true,
            "limits": [
              0.01,
              0.99
            ]
          },
          "description": "Winsorisation settings.",
          "nl_editable": true,
          "properties": {
            "enabled": {
              "constraints": {},
              "default": true,
              "description": "Enable winsorisation.",
              "nl_editable": true,
              "type": "boolean"
            },
            "limits": {
              "constraints": {
                "maxItems": 2,
                "minItems": 2
              },
              "default": [
                0.01,
                0.99
              ],
              "description": "two-sided",
              "items": {
                "type": "number"
              },
              "maxItems": 2,
              "minItems": 2,
              "nl_editable": true,
              "type": "array"
            }
          },
          "type": "object"
        }
      },
      "type": "object"
    },
    "regime": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "annualise_volatility": true,
        "cache": true,
        "enabled": true,
        "lookback": 126,
        "method": "rolling_return",
        "min_observations": 4,
        "neutral_band": 0.001,
        "proxy": "SPX",
        "risk_off_fund_count_multiplier": 0.5,
        "risk_off_label": "Risk-Off",
        "risk_off_target_vol_multiplier": 0.5,
        "risk_on_label": "Risk-On",
        "smoothing": 3,
        "threshold": 0.0
      },
      "description": "Market regime detection settings.",
      "nl_editable": true,
      "properties": {
        "annualise_volatility": {
          "constraints": {},
          "default": true,
          "description": "applies when method: volatility",
          "nl_editable": true,
          "type": "boolean"
        },
        "cache": {
          "constraints": {},
          "default": true,
          "description": "Cache regime signals.",
          "nl_editable": true,
          "type": "boolean"
        },
        "enabled": {
          "constraints": {},
          "default": true,
          "description": "Enable regime detection.",
          "nl_editable": true,
          "type": "boolean"
        },
        "lookback": {
          "constraints": {},
          "default": 126,
          "description": "Lookback window for regime detection.",
          "nl_editable": true,
          "type": "integer"
        },
        "method": {
          "constraints": {},
          "default": "rolling_return",
          "description": "Regime detection method.",
          "nl_editable": true,
          "type": "string"
        },
        "min_observations": {
          "constraints": {},
          "default": 4,
          "description": "Minimum observations for regime signals.",
          "nl_editable": true,
          "type": "integer"
        },
        "neutral_band": {
          "constraints": {},
          "default": 0.001,
          "description": "Neutral band threshold around zero.",
          "nl_editable": true,
          "type": "number"
        },
        "proxy": {
          "constraints": {},
          "default": "SPX",
          "description": "Benchmark proxy used for regime detection.",
          "nl_editable": true,
          "type": "string"
        },
        "risk_off_fund_count_multiplier": {
          "constraints": {},
          "default": 0.5,
          "description": "Scale fund count in risk-off regime.",
          "nl_editable": true,
          "type": "number"
        },
        "risk_off_label": {
          "constraints": {},
          "default": "Risk-Off",
          "description": "Label for risk-off regime.",
          "nl_editable": true,
          "type": "string"
        },
        "risk_off_target_vol_multiplier": {
          "constraints": {},
          "default": 0.5,
          "description": "Scale target volatility in risk-off regime.",
          "nl_editable": true,
          "type": "number"
        },
        "risk_on_label": {
          "constraints": {},
          "default": "Risk-On",
          "description": "Label for risk-on regime.",
          "nl_editable": true,
          "type": "string"
        },
        "smoothing": {
          "constraints": {},
          "default": 3,
          "description": "Smoothing window for regime signal.",
          "nl_editable": true,
          "type": "integer"
        },
        "threshold": {
          "constraints": {},
          "default": 0.0,
          "description": "Threshold for regime classification.",
          "nl_editable": true,
          "type": "number"
        }
      },
      "type": "object"
    },
    "run": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "cache_dir": ".cache/",
        "deterministic": true,
        "log_file": "logs/phase1.log",
        "log_level": "INFO",
        "n_jobs": -1
      },
      "description": "Runtime execution settings.",
      "nl_editable": true,
      "properties": {
        "cache_dir": {
          "constraints": {},
          "default": ".cache/",
          "description": "Directory for runtime cache.",
          "nl_editable": true,
          "type": "string"
        },
        "checkpoint_dir": {
          "constraints": {},
          "default": null,
          "description": "Directory for saving checkpoints.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "deterministic": {
          "constraints": {},
          "default": true,
          "description": "sets NumPy & pandas options",
          "nl_editable": true,
          "type": "boolean"
        },
        "jobs": {
          "constraints": {},
          "default": null,
          "description": "Parallel worker count for a run.",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        },
        "log_file": {
          "constraints": {},
          "default": "logs/phase1.log",
          "description": "Log file path for runtime logs.",
          "nl_editable": false,
          "type": "string"
        },
        "log_level": {
          "constraints": {},
          "default": "INFO",
          "description": "DEBUG | INFO | WARNING | ERROR",
          "nl_editable": true,
          "type": "string"
        },
        "n_jobs": {
          "constraints": {},
          "default": -1,
          "description": "1  all CPUs",
          "nl_editable": true,
          "type": "integer"
        },
        "name": {
          "constraints": {},
          "default": null,
          "description": "Config option for run.name.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "output_dir": {
          "constraints": {},
          "default": null,
          "description": "Config option for run.output_dir.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "seed": {
          "constraints": {},
          "default": null,
          "description": "Random seed used for deterministic runs.",
          "nl_editable": true,
          "type": [
            "integer",
            "null"
          ]
        }
      },
      "type": "object"
    },
    "sample_split": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "date": "2017-12-31",
        "folds": 5,
        "method": "date",
        "ratio": 0.7,
        "rolling_walk": false
      },
      "description": "In-sample/out-of-sample split settings.",
      "nl_editable": true,
      "properties": {
        "date": {
          "constraints": {},
          "default": "2017-12-31",
          "description": "ignored if method=ratio",
          "nl_editable": true,
          "type": "string"
        },
        "folds": {
          "constraints": {},
          "default": 5,
          "description": "for CV, if rolling_walk=true",
          "nl_editable": true,
          "type": "integer"
        },
        "in_end": {
          "constraints": {},
          "default": null,
          "description": "End period for in-sample window.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "in_start": {
          "constraints": {},
          "default": null,
          "description": "Start period for in-sample window.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "method": {
          "constraints": {
            "enum": [
              "date",
              "ratio"
            ]
          },
          "default": "date",
          "description": "date | ratio",
          "enum": [
            "date",
            "ratio"
          ],
          "nl_editable": true,
          "type": "string"
        },
        "out_end": {
          "constraints": {},
          "default": null,
          "description": "End period for out-of-sample window.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "out_start": {
          "constraints": {},
          "default": null,
          "description": "Start period for out-of-sample window.",
          "nl_editable": true,
          "type": [
            "null",
            "string"
          ]
        },
        "ratio": {
          "constraints": {
            "maximum": 1,
            "minimum": 0
          },
          "default": 0.7,
          "description": "ignored if method=date",
          "maximum": 1,
          "minimum": 0,
          "nl_editable": true,
          "type": "number"
        },
        "rolling_walk": {
          "constraints": {},
          "default": false,
          "description": "future-phase feature flag",
          "nl_editable": true,
          "type": "boolean"
        }
      },
      "type": "object"
    },
    "seed": {
      "constraints": {},
      "default": 42,
      "description": "Global random seed for runs.",
      "nl_editable": true,
      "type": "integer"
    },
    "version": {
      "constraints": {},
      "default": "0.1.0",
      "description": "bump when the schema changes",
      "nl_editable": true,
      "type": "string"
    },
    "vol_adjust": {
      "additionalProperties": false,
      "constraints": {},
      "default": {
        "enabled": true,
        "floor_vol": 0.04,
        "target_vol": 0.1,
        "warmup_periods": 0,
        "window": {
          "decay": "ewma",
          "lambda": 0.94,
          "length": 63
        }
      },
      "description": "Risk target configuration for volatility control.",
      "nl_editable": true,
      "properties": {
        "enabled": {
          "constraints": {},
          "default": true,
          "description": "Enable volatility targeting.",
          "nl_editable": true,
          "type": "boolean"
        },
        "floor_vol": {
          "constraints": {},
          "default": 0.04,
          "description": "avoid 100 leverage",
          "nl_editable": true,
          "type": "number"
        },
        "target_vol": {
          "constraints": {
            "minimum": 0
          },
          "default": 0.1,
          "description": "annualised (10%)",
          "minimum": 0,
          "nl_editable": true,
          "type": "number"
        },
        "warmup_periods": {
          "constraints": {},
          "default": 0,
          "description": "zero weights for first N periods",
          "nl_editable": true,
          "type": "integer"
        },
        "window": {
          "additionalProperties": false,
          "constraints": {},
          "default": {
            "decay": "ewma",
            "lambda": 0.94,
            "length": 63
          },
          "description": "Volatility window settings.",
          "nl_editable": true,
          "properties": {
            "decay": {
              "constraints": {
                "enum": [
                  "ewma",
                  "simple"
                ]
              },
              "default": "ewma",
              "description": "ewma | simple",
              "enum": [
                "ewma",
                "simple"
              ],
              "nl_editable": true,
              "type": "string"
            },
            "lambda": {
              "constraints": {
                "maximum": 1,
                "minimum": 0
              },
              "default": 0.94,
              "description": "EWMA decay",
              "maximum": 1,
              "minimum": 0,
              "nl_editable": true,
              "type": "number"
            },
            "length": {
              "constraints": {},
              "default": 63,
              "description": "rolling window (~3 months)",
              "nl_editable": true,
              "type": "integer"
            }
          },
          "type": "object"
        }
      },
      "type": "object"
    }
  },
  "title": "Trend Model configuration",
  "type": "object"
}
