 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/tools/pre-commit b/tools/pre-commit
new file mode 100755
index 0000000000000000000000000000000000000000..09f9b91a8edf062969cc7ea3e9d65ba6dee6636b
--- /dev/null
+++ b/tools/pre-commit
@@ -0,0 +1,9 @@
+#!/bin/sh
+
+# Pre-commit hook to strip output from Jupyter notebooks
+
+FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.ipynb$')
+for file in $FILES; do
+    python3 tools/strip_output.py "$file"
+    git add "$file"
+done
diff --git a/tools/strip_output.py b/tools/strip_output.py
new file mode 100755
index 0000000000000000000000000000000000000000..1cb2f197978c72da07376102397bcf21b5ce9f87
--- /dev/null
+++ b/tools/strip_output.py
@@ -0,0 +1,27 @@
+#!/usr/bin/env python3
+"""Strip output from Jupyter notebooks in-place."""
+import sys
+import nbformat
+
+
+def strip_output(path: str) -> None:
+    with open(path, "r", encoding="utf-8") as f:
+        nb = nbformat.read(f, as_version=nbformat.NO_CONVERT)
+    changed = False
+    for cell in nb.cells:
+        if cell.get("outputs"):
+            cell["outputs"] = []
+            cell["execution_count"] = None
+            changed = True
+    if changed:
+        with open(path, "w", encoding="utf-8") as f:
+            nbformat.write(nb, f)
+
+
+def main(argv: list[str]) -> None:
+    for filename in argv:
+        strip_output(filename)
+
+
+if __name__ == "__main__":
+    main(sys.argv[1:])
 
EOF
)